---
title: "Bhuvana_CS2_EDA.rmd"
author: "Bhuvana A K"
date: "September 11, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r load the csv file with data from 1999 to 2012}
library(dplyr)
library(ggplot2)
library(naniar)
library(gganimate)
library(gapminder)

###Load data from csv file
raceResults  = read.csv("RaceResults99-2k12.csv")
head(raceResults)
summary(raceResults)
str(raceResults)
```

## Analyzing data

You can also embed plots, for example:

```{r check the data values, echo=FALSE}

summary(raceResults)

class(raceResults$Year)
### Check if the year has only unique Numeric values.
### Year field was added during the data scraping process.
years <- raceResults$Year

uniqueYear <- unique(years)
print(uniqueYear)
#hist(y,main='Women Participation 1999-2012',xlab="year",xlim=c(1999,2012))

p <- ggplot(data=raceResults, aes(x=years)) +
geom_bar(stat="count", fill="steelblue") +
geom_text(stat='count', aes(label=..count..), hjust=1.25, color='white',size=3.75)+
theme_minimal()+
labs(title = "Number of Participants from 1999 to 2012",
        y = "Number Of Participants",
        x = "Year")+
theme(plot.title = element_text(hjust = 0.5))
p+ coord_flip()
```

### Summary of all missing values in the data frame.
```{r missing values}
isNR <- function(x)
{
 y <- ifelse(x == "NR",1,0)
}
sum(isNR(raceResults$Age))
summaryOfNRValues <- sapply(raceResults, function(x) sum(isNR(x)))
```

```{r average age across years}

AverageParticipantAge <- raceResults %>%
  group_by(Year) %>%
  summarise(Age = mean(as.numeric(Age)))
AverageParticipantAge

p <- ggplot(AverageParticipantAge, aes(Year, Age, fill = Age)) +
  geom_col() +
  scale_fill_distiller(palette = "Blues", direction = 1) +
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    panel.grid.major.y = element_line(color = "white"),
    panel.ontop = TRUE
  )
p

p + gganimate :: transition_states(Year, wrap = FALSE) +
  shadow_mark() +
  enter_grow() +
  enter_fade()
```

```{r visualize missing values}
###Visualizing NR values using naniar package
nrTona <- function(x){
   x1 <- ifelse(x == "NR",NA,x)
}
raceResults$Division <- sapply(raceResults$Division, function(x) nrTona(x))
raceResults$Age <- sapply(raceResults$Age, function(x) nrTona(x))
raceResults$Pid <- sapply(raceResults$Pid, function(x) nrTona(x))
raceResults$Tid <- sapply(raceResults$Tid, function(x) nrTona(x))
raceResults$Hometown <- sapply(raceResults$Hometown, function(x) nrTona(x))
raceResults$Country <- sapply(raceResults$Country, function(x) nrTona(x))

gg_miss_upset(raceResults)
vis_miss(raceResults,warn_large_data=F)

```
### Divisions in dataset
```{r }

```



Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
